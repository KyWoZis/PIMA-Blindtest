extends layout
block head
  script(src="/javascripts/updatePlaylistTable.js")
  title Music Database
block content
  body(onload="updateTable('', db, 1);")
    .div.tableContainer
      table
        thead
          tr
            th(colspan=1)
              button#prevPage(onclick='changePage(-1)') &lt; Prev
              select#pageNumber(onchange='changePage()', value='1')
              button#nextPage(onclick='changePage(1)') Next &gt;

              p(id='selectedPage') Selected Page: 1
            th(colspan=1)
              input(type='text', name='search', id='search')
            th
              form#addToPlaylistForm(action='addToPlaylist', method='get')
                input(type='hidden', name='user_id', value=user_id)
                input(type='hidden', name='playlist_id', value=playlist_id)
                button#addButton(type='submit') Add to Playlist
          tr
            each column, index in data[0]
              th= index
            th Actions

        tbody#tableBody

    script.
      //load db with data from html
      const db = !{JSON.stringify(data)};
      const user_id = !{JSON.stringify(user_id)};
      const playlist_id = !{JSON.stringify(playlist_id)};

      const searchInput = document.getElementById('search');
      //add event listener to search button
      var t1 = Date.now();

      searchInput.addEventListener('input', function() {
        var t2 = Date.now();
        const searchValue = searchInput.value;
        if (t2 - t1 > 500) {
          updateTable(searchValue, db, 1);
          t1 = t2;
        }
      });

      var currentPage = 1;

      function changePage(offset = 0) {
        var selectElement = document.getElementById('pageNumber');
        var selectedPageElement = document.getElementById('selectedPage');
        var prevPageButton = document.getElementById('prevPage');
        var nextPageButton = document.getElementById('nextPage');

        currentPage = parseInt(selectElement.value) + offset;

        // Update selected page
        selectElement.value = currentPage;
        selectedPageElement.innerText = 'Selected Page: ' + currentPage;

        // Enable/disable navigation buttons based on page number
        prevPageButton.disabled = currentPage <= 1;
        nextPageButton.disabled = currentPage >= selectElement.options.length;

        updateTable(searchInput.value, db, currentPage, false);
      }

      // Initialize page on load
      document.addEventListener('DOMContentLoaded', function () {
        changePage();
      });

